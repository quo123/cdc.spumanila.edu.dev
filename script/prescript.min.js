String.prototype.str_replace=function(a,c){for(var d=this,f=0;f<a.length;f++)d=d.replace(new RegExp(a[f],"g"),c[f]);return d};function htmlDecode(a){return a=a.str_replace("&amp; &lt; &gt; &quot; &#x27; &#x2F; &emsp; &plus;".split(" "),"&<>\"'/\t+".split(""))}function htmlEncode(a){return a=a.str_replace("[&] [<] [>] [\"] ['] [/] [\t] [+]".split(" "),"&amp; &lt; &gt; &quot; &#x27; &#x2F; &emsp; &plus;".split(" "))}function attrEscape(a){return a=a.replace('"','"')}
$.fn.scrollView=function(){return this.each(function(){$("html, body").animate({scrollTop:$(this).offset().top},200)})};var imgLoading='<img src="/images/loading.gif" />',phpSeeker="/ajax/seeker.php",phpActivity="/ajax/activity.php",phpSave="/ajax/save.php",phpStudentEval="/ajax/student_eval.php",phpLogin="/ajax/login.php",phpLogout="/ajax/logout.php",phpRegister="/ajax/register.php",phpGetStudentInfo="/ajax/get_studentinfo.php",phpReports="/ajax/reports.php";
$(function(){function a(b,a,c){return $(b).dialog({resizable:!1,autoOpen:!1,height:a,width:c,modal:!0,close:function(){$(this).find("form")[0].reset();reset(this,"");resetBox($(this).find(".others"),function(){$(".edit-slider").slider("option","value",0)});$(this).find("input, select").unbind("change.autoSave")},buttons:{Save:function(){$(this).find("input[type=submit]").click()},Cancel:function(){$(this).dialog("close")}}}).on("submit","form",function(a){a.preventDefault();a=$(this).serialize();
a+="&edit=&type="+g+"&actid="+l;$.post(phpActivity,a,function(a){errorWrapper(a,function(){$(b).dialog("close");"oncampus"===g?populateActTable("onid",e,$("#oncampus-form")):populateActTable("offid",e,$("#offcampus-form"));refreshResults()})})}).on("change","select",function(){var b=$(this).siblings(".edit-textbox");"others"===$(this).val()?b.prop("disabled",!1).attr("placeholder","Please specify").removeClass("invisible").addClass("focusglow").prop("required",!0):resetBox(b)})}function c(b,a,c,d){var f=
$(b).parents("div.account-form").attr("id");g=f.substring(0,f.indexOf("-"));l=$(b).parents("tr").attr("data-id");c={editact:l,type:g,field:c};null!==a?$.get(phpSeeker,c,function(b){if(0<a.dialog().find(".edit-combobox ").length){var c=[];a.dialog().find(".edit-combobox > option").each(function(){var b=$(this).val();""!==b&&"others"!==b&&c.push(b)});a.dialog("open");-1<c.indexOf(b)?a.dialog().find(".edit-combobox").val(b):(a.dialog().find(".edit-combobox").val("others"),a.dialog().find(".edit-combobox").trigger("change"),
a.dialog().find(".edit-textbox").focus().val(b))}else a.dialog("open").find(".edit-textbox").val(b);null!==d&&(b<d?a.dialog().find(".ui-slider-range").removeClass("greenslider").addClass("redslider"):a.dialog().find(".ui-slider-range").removeClass("redslider").addClass("greenslider"),a.dialog().find(".edit-slider").slider("option","value",b))}):(b=$(b).text(),c={edit:"",type:g,actid:l,cert:{NONE:1,OK:0}[b]},$.post(phpActivity,c,function(b){errorWrapper(b,function(){"oncampus"===g?populateActTable("onid",
e,$("#oncampus-form")):populateActTable("offid",e,$("#offcampus-form"));refreshResults()})}))}$("#tabs").tabs();$(document).tooltip({track:!0,items:"li.reqs",show:!1,hide:!1});var d=$("#login-form").dialog({resizable:!1,autoOpen:!1,height:273,width:300,modal:!0,close:function(){$(this).find("form")[0].reset();reset(this,"Login","")}}).on("submit",function(b){b.preventDefault();var a=this;b=$(this).find("input[type=submit]");var c=$(this).find("form")[0],e=$(c).serialize(),g=$(this).find(".response");
$(b).val("").addClass("button-loading");if($(c).data("submitting"))return!1;$(".submit",c).prop("disabled",!0);$(c).data("submitting",!0);$.post(phpLogin,e,function(b){errorWrapper(b,function(){$(g).html(b);-1<b.indexOf("Welcome back,")?(d.dialog("option","closeOnEscape",!1),setTimeout(function(){d.dialog("close");window.location.replace("/")},2E3)):reset(a,"Login")})})}),f=$("#register-form").dialog({resizable:!1,autoOpen:!1,height:296,width:300,modal:!0,close:function(){$(this).find("form")[0].reset();
reset(this,"Register","")}}).on("submit",function(b){b.preventDefault();var a=this;b=$(this).find("input[type=submit]");var c=$(this).find("form")[0],d=$(c).serialize(),e=$(this).find(".response");$(b).val("").addClass("button-loading");if($(c).data("submitting"))return!1;$(".submit",c).prop("disabled",!0);$(c).data("submitting",!0);$.post(phpRegister,d,function(b){errorWrapper(b,function(){$(e).html(b);"Registration successful!"===b?setTimeout(function(){f.dialog("close")},2E3):reset(a,"Register")})})});
$("#login-button").on("click",function(){d.dialog("open")});$("#register-button").on("click",function(){f.dialog("open")});$("#logout-button").on("click",function(){$.get(phpLogout,function(b){alertWrapper(b,null,function(){window.location.reload()})})});var k=$("#add-form").dialog({resizable:!1,autoOpen:!1,height:510,width:925,modal:!0,close:function(){$(this).find("form")[0].reset();reset(this,"","Input student information.")},buttons:{"Add student":function(){$(this).find("input[type=submit]").click()},
Cancel:function(){$(this).dialog("close")}}}).on("submit",function(b){b.preventDefault();var a=this;b=$(this).find("form")[0];var c=$(b).serialize(),d=$(this).find(".response");if($(b).data("submitting"))return!1;$(".submit",b).prop("disabled",!0);$(b).data("submitting",!0);$.post(phpGetStudentInfo,c,function(b){errorWrapper(b,function(){"Record added!"===b?(alertWrapper(b,null,function(){k.dialog("close")}),studentSeeker(null,null,"RECENT")):($(d).html(b),reset(a,""))})})});$("#add-student").button().on("click",
function(){k.dialog("open")});$("#bday, #Bday").datepicker({changeMonth:!0,changeYear:!0,yearRange:"c-40:c"}).on("change",function(){var b=toUTC($(this).val()),a=toUTC(Date.now()),b=Math.floor((a-b)/315576E5),b=0<b?b:0;$("#age, #Age").val(b)});$("#student-summary-records table").tablesorter();var p=$("#student-summary").dialog({resizable:!1,autoOpen:!1,height:420,width:667,modal:!0,open:function(){populateStudentTable($(this))},close:function(){$(this).find("table.records tbody").html("")},buttons:{Done:function(){$(this).dialog("close")}}});
$("#searchbutton").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}).click(function(){0===$("#searchfield").val().trim().length?p.dialog("open"):$("#searchbox").submit()});0<$("#searchfield").length&&studentSeeker(null,null,"RECENT");$("#searchfield").on("input",function(){var b=$(this).val();0===b.length?(studentSeeker(null,null,"RECENT"),$("#searchfield").attr("data","-1")):"ALL"===b&&(studentSeeker(null,null,"ALL"),$("#searchfield").attr("data",
"-1"))});$("#searchbox").on("submit",function(b){b.preventDefault();$("#search-results").html("<legend>Searching</legend>"+imgLoading);studentSeeker(null,null,$("#searchfield").val());$("#searchfield").attr("data","-1")});$("#searchfield").autocomplete({source:phpSeeker,minLength:1,autoFocus:!0,select:studentSeeker});var h=$("#edit-form").dialog({resizable:!1,autoOpen:!1,height:410,width:925,modal:!0,close:function(){$(this).find("form")[0].reset();reset(this,"","Changes will be automatically saved.");
h.dialog().find("input, select").unbind("change.autoSave")},buttons:{Delete:function(){delWrapper(function(){$.post(phpActivity,{delstud:e},function(b){errorWrapper(b,function(){alertWrapper(b,null,function(){h.dialog("close")});studentSeeker(null,null,"RECENT")})})})},Done:function(){$(this).dialog("close")}}}).on("submit",function(b){b.preventDefault();$(this).dialog("close")});$("#Bday").on("change",function(){$("#Age").change()});var e;$("#search-results").on("click",".result-edit",function(){var b,
a=$(this).attr("data"),c={edit:a};e=a;$.get(phpSeeker,c,function(a){errorWrapper(a,function(){b=JSON.parse(a);h.dialog("open").find("input").attr("autocomplete","off");$.each(b,function(a,c){h.dialog().find("#"+a).val(c);h.dialog().find("#"+a).on("focus",function(){$(this).addClass("edit-editing")}).focusout(function(){$(this).removeClass("edit-editing")});h.dialog().find("#"+a).on("change.autoSave",function(){var c=$(this),d=c.prop("validity");""!==c.val().trim()&&!0===d.valid?(c.removeClass("edit-editing edit-error"),
c.addClass("edit-saved"),d=$("#"+a).serialize(),d="sid="+b.sid+"&"+d,$.post(phpSave,d,function(b){refreshResults()}),setTimeout(function(){c.removeClass("edit-saved")},2E3)):c.addClass("edit-error")})})})})}).on("click",".reqs",function(b){e=$(this).parent("ul").siblings(".result-edit").attr("data");var a=$(this);b=a.attr("data-id");if(-1<["rp"].indexOf(b))a=a.hasClass("good")?0:1,$.post(phpSave,"sid="+e+"&"+b+"="+a,function(b){refreshResults()});else if("re"===b)$.get(phpSeeker,{completereqs:e},
function(b){errorWrapper(b,function(){H.dialog("open")})});else if("ri"===b)u.dialog("open"),g="oncampus";else if("ro"===b||"rc"===b)n.dialog("open"),g="offcampus"}).on("click",".result-details",function(b){e=$(this).siblings(".result-edit").attr("data");m.show().position({my:"left top",at:"left bottom",of:this}).focus();return!1});var m=$("#details-menu").menu().hide();m.blur(function(){$(this).hide()});var g,u=$("#oncampus-form").dialog({resizable:!1,autoOpen:!1,height:450,width:789,modal:!0,open:function(){g=
"oncampus";populateActTable("onid",e,$(this))},close:function(){$(this).find("table.records tbody").html("")},buttons:{Done:function(){$(this).dialog("close")}}}),v=$("#oncampus-add").dialog({resizable:!1,autoOpen:!1,height:390,width:402,modal:!0,open:function(){$("#onhours").val($("#slider-onhours").slider("value"));defaultSem("#oncampus-add")},close:function(){$(this).find("form")[0].reset();reset(this,"","0000, ");resetBox($(this).find(".others"),function(){$("#slider-onhours").slider("option",
"value",0)});$(this).dialog().find("input, select").unbind("change.autoSave")},buttons:{Add:function(){$(this).find("input[type=submit]").click()},Cancel:function(){$(this).dialog("close")}}}).on("submit","form",function(b){b.preventDefault();b=$(this).serialize();b+="&type=oncampus&student="+e;$.post(phpActivity,b,function(b){-1<b.indexOf("Record added!")?(alertWrapper("Record added!"),v.dialog("close"),refreshResults(),populateActTable("onid",e,$("#oncampus-form"))):alertWrapper(b)})}).on("change",
"select",function(){var b=$("#on-"+$(this).attr("name"));"others"===$(this).val()?b.prop("disabled",!1).attr("placeholder","Please specify").removeClass("invisible").addClass("focusglow").prop("required",!0):resetBox(b)}).on("change.autoSave",".year",function(){var b=parseInt($(this).val())+1;$(".response").text(b+", ")});$("#slider-onhours, #slider-edit-onhours").slider({range:"min",value:0,min:0,max:8,step:.5,slide:function(b,a){$("#onhours, #onhours-edit").val(a.value);8>a.value?$(this).find(".ui-slider-range").removeClass("greenslider").addClass("redslider"):
$(this).find(".ui-slider-range").removeClass("redslider").addClass("greenslider")}});$("#oncampus-menu").on("click",function(){u.dialog("open");g="oncampus"});$("#oncampus-button").button().on("click",function(){v.dialog("open")});var n=$("#offcampus-form").dialog({resizable:!1,autoOpen:!1,height:450,width:1149,modal:!0,open:function(){g="offcampus";populateActTable("offid",e,$(this))},close:function(){$(this).find("table.records tbody").html("")},buttons:{Done:function(){$(this).dialog("close")}}}),
w=$("#offcampus-add").dialog({resizable:!1,autoOpen:!1,height:470,width:402,modal:!0,open:function(){$("#offhours").val($("#slider-offhours").slider("value"));defaultSem("#offcampus-add")},close:function(){$(this).find("form")[0].reset();reset(this,"","0000, ");resetBox($(this).find(".others"),function(){$("#slider-offhours").slider("option","value",0)});$(this).dialog().find("input, select").unbind("change.autoSave")},buttons:{Add:function(){$(this).find("input[type=submit]").click()},Cancel:function(){$(this).dialog("close")}}}).on("submit",
"form",function(b){b.preventDefault();b=$(this).serialize();b+="&type=offcampus&student="+e;$.post(phpActivity,b,function(b){-1<b.indexOf("Record added!")?(alertWrapper("Record added!"),w.dialog("close"),refreshResults(),populateActTable("offid",e,$("#offcampus-form"))):alertWrapper(b)})}).on("change","select",function(){var b=$("#off-"+$(this).attr("name"));"others"===$(this).val()?b.prop("disabled",!1).attr("placeholder","Please specify").removeClass("invisible").addClass("focusglow").prop("required",
!0):resetBox(b)}).on("change.autoSave",".year",function(){var b=parseInt($(this).val())+1;$(".response").text(b+", ")});$("#slider-offhours, #slider-edit-offhours").slider({range:"min",value:0,min:0,max:4,step:.5,slide:function(b,a){$("#offhours, #offhours-edit").val(a.value);4>a.value?$(this).find(".ui-slider-range").removeClass("greenslider").addClass("redslider"):$(this).find(".ui-slider-range").removeClass("redslider").addClass("greenslider")}});$("#offcampus-menu").on("click",function(){n.dialog("open");
g="offcampus"});$("#offcampus-button").button().on("click",function(){w.dialog("open")});var x=$("#actname-menu-off").menu().hide();x.blur(function(){$(this).hide()});var y=$("#actname-menu-on").menu().hide();y.blur(function(){$(this).hide()});var l,z,q;$(".records").on("click",".t-actname",function(b){var a=$(this).parents("div.account-form").attr("id"),c="offcampus-form"===a?x:y;g=a.substring(0,a.indexOf("-"));c.show().position({my:"left top",at:"right bottom",of:b}).focus();l=$(this).parents("tr").attr("data-id");
return!1}).on("click",".t-start, .t-end",function(b){z=$(this).parents(".table-rows").attr("data-id");A.show().position({my:"left top",at:"right bottom",of:b}).focus();return!1}).on("click",".t-category",function(){c(this,I,"category")}).on("click",".t-initiator",function(){c(this,J,"initiator")}).on("click",".t-organizer",function(){c(this,K,"organizer")}).on("click",".t-address",function(){c(this,L,"address")}).on("click",".t-pointperson",function(){c(this,M,"pointperson")}).on("click",".t-contact",
function(){c(this,N,"contact")}).on("click",".t-hours",function(){"oncampus"===g?c(this,O,"hours",8):"offcampus"===g&&c(this,P,"hours",4)}).on("click",".t-cert",function(){c(this,null,"cert")}).on("click",".t-eval-schoolyear, .t-eval-semester",function(b){q=$(this).parents(".table-rows").attr("data-id");B.show().position({my:"left top",at:"right bottom",of:b}).focus();return!1});var A=$("#schedule-menu").menu().hide();A.blur(function(){$(this).hide()});$(".sched-delete-menu").on("click",function(){$.post(phpActivity,
{"delete":z},function(b){-1<b.indexOf("Record deleted!")?(alertWrapper("Schedule deleted!"),populateSchedTable({actid:l,type:g},$("#schedule-form"))):alertWrapper(b)})});var Q=$("#schedule-form").dialog({resizable:!1,autoOpen:!1,height:300,width:409,modal:!0,open:function(){var b=$(this);populateSchedTable({actid:l,type:g},b)},close:function(){$(this).find("table.records tbody").html("")},buttons:{Done:function(){$(this).dialog("close")}}}),C=$("#schedule-add").dialog({resizable:!1,autoOpen:!1,height:210,
width:370,modal:!0,close:function(){$(this).find("form")[0].reset();reset(this,"")},buttons:{Add:function(){$(this).find("input[type=submit]").click()},Cancel:function(){$(this).dialog("close")}}}).on("submit","form",function(b){b.preventDefault();var a=$(this).serialize(),a=a+("&type="+g+"&actid="+l);$.post(phpActivity,a,function(b){errorWrapper(b,function(){-1<b.indexOf("Record added!")?(alertWrapper("Schedule added!"),C.dialog("close"),populateSchedTable(a,$("#schedule-form"))):alertWrapper(b)})})});
$(".act-sched-menu").on("click",function(){Q.dialog("open")});$("#addsched-button").button().on("click",function(){C.dialog("open")});$("#sched-start, #sched-end").datepicker({changeMonth:!0,changeYear:!0,yearRange:"c-10:c+1"});$(".act-delete-menu").on("click",function(){delWrapper(function(){$.post(phpActivity,{delact:l,type:g},function(b){errorWrapper(b,function(){alertWrapper(b);"oncampus"===g?populateActTable("onid",e,$("#oncampus-form")):populateActTable("offid",e,$("#offcampus-form"))})})})});
var R=a("#edit-actname-form",155,395);$(".act-edit-menu").on("click",function(){$.get(phpSeeker,{editact:l,type:g,field:"actname"},function(b){R.dialog("open").find(".edit-textbox").val(b)})});var I=a("#edit-category-form",155,405),J=a("#edit-initiator-form",155,405),K=a("#edit-organizer-form",155,395),L=a("#edit-address-form",155,395),M=a("#edit-pointperson-form",155,275),N=a("#edit-contact-form",155,275),O=a("#edit-onhours-form",155,275),P=a("#edit-offhours-form",155,275),S=$("#settings-form").dialog({resizable:!1,
autoOpen:!1,height:260,width:300,modal:!0,open:function(){$.get(phpSeeker+"?editsettings",function(b){errorWrapper(b,function(){var a=JSON.parse(b);$.each(a,function(b,a){$("#settings-"+b).val(a)});$("#endyear").text(a.year+1)})})},close:function(){$(this).find("form")[0].reset();reset(this,"","Set current school year and semester.");$(this).dialog().find("input, select").unbind("change.autoSave")},buttons:{Done:function(){$(this).dialog("close")}}}).on("submit",function(b){b.preventDefault();$(this).dialog("close")}).on("change.autoSave",
"#settings-year",function(){var b=parseInt($(this).val())+1;$("#endyear").text(b);autoSaver(this)}).on("change.autoSave","#settings-sem",function(){autoSaver(this)});$("#settings-button").on("click",function(){S.dialog("open")});var H=$("#edit-eval-form").dialog({resizable:!1,autoOpen:!1,height:190,width:375,modal:!0,open:function(){var b=$(this);$.get(phpSeeker,{evalcode:e},function(a){errorWrapper(a,function(){b.find("#eval-request").val(a);"OK"===a?b.find(".noeval").addClass("nodisplay"):b.find(".noeval").removeClass("nodisplay")})});
$.get(phpSeeker+"?editsettings",function(a){errorWrapper(a,function(){var c=JSON.parse(a),d=c.year+1;$(b).siblings(".ui-dialog-titlebar").children(".ui-dialog-title").html("Evaluation ("+toOrdinal(c.sem)+" Semester, A.Y. "+c.year+"&ndash;"+d+")")})})},close:function(){$(this).find("form")[0].reset();reset(this,"")},buttons:{Done:function(){$(this).dialog("close")}}}).on("submit",function(b){b.preventDefault()});$("#eval-request-button").button().on("click",function(){var b=$("#edit-eval-form");$.get(phpSeeker,
{genreq:e},function(a){errorWrapper(a,function(){b.find("#eval-request").val(a)})})});var B=$("#eval-menu").menu().hide();B.blur(function(){$(this).hide()});var T=$("#view-eval").dialog({resizable:!1,autoOpen:!1,height:270,width:309,modal:!0,open:function(){var b=$(this);populateEvalTable({vieweval:e},b)},close:function(){$(this).find("table.records tbody").html("")},buttons:{Done:function(){$(this).dialog("close")}}});$("#eval-view-button").button().on("click",function(){T.dialog("open")});$(".eval-view-menu").on("click",
function(){D.dialog("open")});$(".eval-delete-menu").on("click",function(){delWrapper(function(){$.post(phpActivity,{deleval:q},function(b){errorWrapper(b,function(){alertWrapper(b);populateEvalTable({vieweval:e},$("#view-eval"))})})})});var D=$("#view-eval-form").dialog({resizable:!1,autoOpen:!1,height:550,width:700,modal:!0,open:function(){var b=$(this);$.get(phpSeeker,{viewevalform:q},function(a){errorWrapper(a,function(){var c=JSON.parse(a);$.each(c,function(a,c){b.find("#"+a).val(c)});b.siblings(".ui-dialog-titlebar").children(".ui-dialog-title").html(formatYearSem(c.schoolyear,
c.semester));c=b.find(".rating-slider");$.each(c,function(b,a){var c=$(a).siblings(".invisible.hourbox").val();$(a).slider("option","value",c).slider("option","disabled",!0);3>c?($(a).find(".ui-slider-range").removeClass("greenslider").addClass("redslider"),$(a).siblings(".rate-threshold").show()):($(a).find(".ui-slider-range").removeClass("redslider").addClass("greenslider"),$(a).siblings(".rate-threshold").hide())});b.animate({scrollTop:0},200)})||D.dialog("close")})},close:function(){$(this).find("form")[0].reset();
$(this).siblings(".ui-dialog-titlebar").children(".ui-dialog-title").html("Evaluation");reset(this,"");resetArea($(this).find(".rate-threshold textarea"),function(){$(".rating-slider").slider("option","value",4)})},buttons:{Close:function(){$(this).dialog("close")}}}).on("submit",function(b){b.preventDefault()}),r=0,t=1;$("#report-questions").selectmenu({width:120,select:function(b,a){t=a.item.value;populateReports({question:t,type:r})}});$("#report-mod").selectmenu({width:95,select:function(b,a){r=
"Current"===a.item.label?0:1;populateReports({question:t,type:r})}});var E;$("#evaluate").button({icons:{primary:"ui-icon-contact"}}).on("click",function(){F.dialog("open")});var F=$("#get-eval-form").dialog({dialogClass:"no-close",resizable:!1,autoOpen:!1,height:160,width:200,modal:!0,close:function(){$(this).find("form")[0].reset();reset(this,"")},buttons:{Go:function(){$(this).find("input[type=submit]").click()},Cancel:function(){$(this).dialog("close")}}}).on("submit",function(a){a.preventDefault();
a=$(this).find("form").serialize();$.post(phpStudentEval,a,function(a){errorWrapper(a,function(){var b=JSON.parse(a);E=b.id;b=b.name+" ["+b.course+"-"+b.year+"] ("+formatYearSem(b.schoolyear,b.semester)+")";F.dialog("close");$("#eval-form").siblings(".ui-dialog-titlebar").children(".ui-dialog-title").html(b);G.dialog("open")})})}),G=$("#eval-form").dialog({resizable:!1,autoOpen:!1,height:550,width:700,modal:!0,open:function(){$(this).find(".rate-threshold").hide();$(this).find(".ui-slider-range").removeClass("redslider").addClass("greenslider");
resetArea($(this).find(".rate-threshold textarea"));$(this).animate({scrollTop:0},200)},close:function(){$(this).find("form")[0].reset();$(this).siblings(".ui-dialog-titlebar").children(".ui-dialog-title").html("Evaluation");reset(this,"");resetArea($(this).find(".rate-threshold textarea"),function(){$(".rating-slider").slider("option","value",4)})},buttons:{Submit:function(){$(this).find("input[type=submit]").click()},Cancel:function(){$(this).dialog("close")}}}).on("submit",function(a){a.preventDefault();
a=$(this).find("form").serializeArray();a.push({name:"evaluation",value:E});$.post(phpStudentEval,a,function(a){errorWrapper(a,function(){alertWrapper(a,"Evaluation",function(){G.dialog("close")})})})});$("#slider-rate-act, #slider-rate-part").slider({range:"min",value:4,min:1,max:4,slide:function(a,c){var d=$(this);d.siblings(".invisible.hourbox").val(c.value);3>c.value?(d.find(".ui-slider-range").removeClass("greenslider").addClass("redslider"),d.siblings(".rate-threshold").show(200,function(){$(this).find("textarea").prop("disabled",
!1).prop("required",!0);"0"===d.siblings(".changedummy").val()&&d.siblings(".changedummy").val("1").trigger("change")})):(d.find(".ui-slider-range").removeClass("redslider").addClass("greenslider"),resetArea(d.siblings(".rate-threshold").find("textarea"),function(){d.siblings(".rate-threshold").hide(200,function(){"1"===d.siblings(".changedummy").val()&&d.siblings(".changedummy").val("0").trigger("change")})}))}})});
function formatYearSem(a,c){var d=parseInt(a)+1;a=a+"&ndash;"+d;d=parseInt(c);return toOrdinal(d)+" Semester, A.Y. "+a}
function populateEvalTable(a,c){var d={schoolyear:"School Year",semester:"Semester"};$.get(phpSeeker,a,function(a){a=JSON.parse(a);var k=$(c).find("table.records tbody").html("");$.each(a,function(a,c){var e=$(k).append("<tr>"),f=$(e).find("tr:last").addClass("table-rows");$.each(c,function(a,c){if("id"!==a){f.append("<td>");var e=f.find("td:last");e.text(c);e.attr("title",d[a]).addClass("t-eval-"+a)}else"id"===a&&f.attr("data-id",c)})})})}
function populateSchedTable(a,c){var d={start:"Start Time",end:"End Time"};$.get(phpSeeker+"?getsched",a,function(a){a=JSON.parse(a);var k=$(c).find("table.records tbody").html("");$.each(a,function(a,c){var e=$(k).append("<tr>"),f=$(e).find("tr:last").addClass("table-rows");$.each(c,function(a,c){if("dateid"!==a){f.append("<td>");var e=f.find("td:last");e.text(c);e.attr("title",d[a]).addClass("t-"+a)}else"dateid"===a&&f.attr("data-id",c)})})})}
function populateActTable(a,c,d){var f,k;"offid"===a?(f={acts:"offcampus",sid:c},k={actname:"Activity Name",organizer:"Organizer",address:"Address",pointperson:"Point Person",contact:"Contact Number",schoolyear:"School Year",semester:"Semester",hours:"Hours Served",cert:"Certificate"}):"onid"===a&&(f={acts:"oncampus",sid:c},k={actname:"Activity Name",category:"Category",initiator:"Initiator",schoolyear:"School Year",semester:"Semester",hours:"Hours Served"});var p=Object.getOwnPropertyNames(k),h;
$.get(phpSeeker,"editsettings",function(a){a=JSON.parse(a);h=a.year+"."+a.sem});$.get(phpSeeker,f,function(c){c=JSON.parse(c);var f=$(d).find("table.records tbody").html("");$.each(c,function(c,d){var e=$(f).append("<tr>"),n=$(e).find("tr:last").addClass("table-rows"),e=d.schoolyear+"."+d.semester;parseFloat(h)>parseFloat(e)&&n.addClass("old");$.each(d,function(c,d){if(-1<$.inArray(c,p)){n.append("<td>");var e=n.find("td:last");switch(c){case "schoolyear":e.html(d+" &ndash; "+(parseInt(d)+1));break;
case "eval":case "cert":e.text("0"===d?"NONE":"OK");break;default:e.text(d)}e.attr("title",k[c]).addClass("t-"+c)}else c===a&&n.attr("data-id",d)})})})}
function populateStudentTable(a){var c={lname:"Last Name",fname:"First Name",mname:"Middle Initial",course:"Course"};$.get(phpSeeker+"?allstudents",function(d){d=JSON.parse(d);var f=$(a).find("table.records tbody").html("");$.each(d,function(a,d){var h=$(f).append("<tr>"),e=$(h).find("tr:last").addClass("table-rows");$.each(d,function(a,d){if("sid"!==a){e.append("<td>");var f=e.find("td:last");f.text(d);f.attr("title",c[a]).addClass("t-"+a)}else"sid"===a&&e.attr("data-id",d)})});$("#student-summary-records table").trigger("update")})}
function populateReports(a){$("#report-results").html("<legend>Collecting answers</legend>"+imgLoading);$.get(phpReports,a,function(a){$("#report-results").html("<legend>Answers</legend>");errorWrapper(a,function(){console.log(a);var d=JSON.parse(a);$("#quest").text(d.quest);$.each(d.ans,function(a,c){var d=$("<div>").addClass("resultbox noselect"),h=$("<span>").text(c.fullname).addClass("report-fullname"),e=parseInt(c.year)+1,e=$("<span>").text(toOrdinal(parseInt(c.sem))+" semester, A.Y. "+c.year+
" - "+e).addClass("report-yearsem"),m=null===c.answer2?c.answer:0<parseInt(c.answer)?"Rating: "+c.answer:"Core Value: "+c.answer,m=$("<p>").text(m).addClass("report-answer good");0<parseInt(c.answer)&&3>parseInt(c.answer)&&m.removeClass("good").addClass("bad");null===c.answer2&&m.removeClass("good bad");var g=null!==c.answer2?$("<p>").text(c.answer2).addClass("report-answer"):null;d.append(h,e,m,g);$("#report-results").append(d)})})})}
function defaultSem(a){$.get(phpSeeker+"?editsettings",function(c){errorWrapper(c,function(){var d=JSON.parse(c),f=parseInt(d.year)+1;$(a).find(".year").val(d.year);$(a).find(".response").text(f+", ");$(a).find(".sem").val(d.sem)})})}function toOrdinal(a){switch(a.toString().charAt(a.length)){case "1":return a+"st";case "2":return a+"nd";case "3":return a+"rd";default:return a+"th"}}
function resetBox(a,c){c&&"function"===typeof c&&c();return a.prop("disabled",!0).val("").attr("placeholder","").removeClass("focusglow").addClass("invisible").prop("required",!1)}function resetArea(a,c){c&&"function"===typeof c&&c();return a.prop("disabled",!0).val("").prop("required",!1)}
function autoSaver(a){var c=$(a);a=c.prop("validity");""!==c.val().trim()&&!0===a.valid?(c.removeClass("edit-editing edit-error"),c.addClass("edit-saved"),a=c.serialize(),$.post(phpSave,a,function(a){refreshResults()}),setTimeout(function(){c.removeClass("edit-saved")},2E3)):c.addClass("edit-error")}function toUTC(a){a=new Date(a);return Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}
function refreshResults(){""===$("#searchfield").val().trim()?studentSeeker(null,null,"RECENT"):0<$("#searchfield").attr("data")?studentSeeker(null,null,$("#searchfield").attr("data")):studentSeeker(null,null,$("#searchfield").val())}function studentSeeker(a,c,d){a=d;c&&(a=c.item.id,$("#searchfield").attr("data",c.item.id));$.get(phpSeeker,{student:a},function(a){errorWrapper(a,function(){$("#search-results").html(a)})})}
function reset(a,c,d){$(".submit",a).prop("disabled",!1);$(a).find("form").data("submitting",!1);$(a).find("input[type=submit]").removeClass("button-loading");$(a).find("input[type=submit]").removeAttr("style");$(a).find("input[type=submit]").val(c);(d||""===d)&&$(a).find(".response").html(d)}function errorWrapper(a,c,d,f){if(-1<a.indexOf("Error:"))return d=d&&""!==d.trim()?d:"Error",alertWrapper(a.substring(6),d,f),!1;c();return!0}
function delWrapper(a){return a&&"function"===typeof a?$("#confirm-delete-form").dialog({resizable:!1,autoOpen:!0,height:160,width:375,modal:!0,dialogClass:"no-close",close:function(){$(this).find("form")[0].reset();reset(this,"")},buttons:{Delete:function(){$(this).find("input[type=submit]").click()},Cancel:function(){$(this).dialog("close")}}}).on("submit",function(c){c.preventDefault();c=$(this).find(".focusglow").val();c=c.trim().toLowerCase();"delete"===c&&(a(),$(this).dialog("close"))}):!1}
function alertWrapper(a,c,d){c=c&&""!==c.trim()?c:"Alert";return $('<div id="modal-alert-dialog" class="account-form no-close" title="'+c+'"><p id="modal-alert-msg">Alert!</p></div>').dialog({resizable:!1,autoOpen:!0,minHeight:120,minWidth:200,modal:!0,dialogClass:"no-close",open:function(){$(this).find("#modal-alert-msg").text(a)},close:function(){d&&"function"===typeof d&&d()},buttons:{Ok:function(){$(this).dialog("close")}}})}
function confirmWrapper(a,c,d){c=c&&""!==c.trim()?c:"Confirm";return d&&"function"===typeof d?$('<div id="modal-confirm-dialog" class="account-form" title="'+c+'"><form><p id="modal-confirm-msg">Confirm?</p><input type="submit" tabindex="-1" class="dummy-submit"></form></div>').dialog({resizable:!1,autoOpen:!0,minHeight:120,minWidth:300,modal:!0,dialogClass:"no-close",open:function(){$(this).find("#modal-confirm-msg").text(a)},close:function(){$(this).find("form")[0].reset()},buttons:{Ok:function(){$(this).find("input[type=submit]").click()},
Cancel:function(){$(this).dialog("close")}}}).on("submit",function(a){a.preventDefault();d();$(this).dialog("close")}):!1};
